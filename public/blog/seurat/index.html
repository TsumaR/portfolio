<!DOCTYPE html>
<html lang="ja">
    <head>
        
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="description" content="Website Description">
<title>
Seuratを使ってみる - Ryota Wagatsuma
</title>



        <meta property="og:title" content="Seuratを使ってみる - Ryota Wagatsuma" />
<meta property="og:type" content="website" />
<meta property="og:description" content="Website Description"/>
<meta property="og:url" content="https://www.tsumar.com/blog/seurat/"/>
<meta property="og:site_name" content="Ryota Wagatsuma"/>




<meta property="og:image" content="https://www.tsumar.com/home/profile.JPG"/>




        
<link rel="shortcut icon" href="/img/fav.ico">


        





<link rel="stylesheet" href="/css/main.min.1eaffbdff5446b797511e3967e8419d2ad7851677604addf74d560bdfc5f91c7.css" integrity="sha256-Hq/73/VEa3l1EeOWfoQZ0q14UWd2BK3fdNVgvfxfkcc=" crossorigin="anonymous" media="screen">





        
        
        
        
    </head>
    <body>
        <section id="top" class="section">
            
            <div class="container hero  fade-in one ">
                

    <h1 class="bold-title is-1">Blog</h1>


            </div>
            
            <div class="section  fade-in two ">
                
<div class="container">
    <hr>
    <nav class="navbar" role="navigation" aria-label="main navigation">
        
        <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false" >
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
        <div class="navbar-menu " id="navMenu">
            
            
            
            
            <a class="navbar-item" href="/"></a>
            

            
            

            
                
            

            
                
            

            
            
            
            
            
            <a class="navbar-item" href="/#about">About</a>
            
            
            
            
            
                
                
                
                
                  <a class="navbar-item" href="https://www.tsumar.com/projects/">
                  
                  Work
                  
                  </a>
                
                
            
            
            
            
            
                
                
                
                
                  <a class="navbar-item" href="https://www.tsumar.com/blog/">
                  
                  
                  
                  </a>
                
                
            
            
            
            

            
            
            <a class="navbar-item" href="/#contact">Contact</a>
            
            

            

            
            
        </div>
    </nav>
    <hr>
</div>



                
    <div class="container">
        <h2 class="title is-1 top-pad strong-post-title">
            <a href="https://www.tsumar.com/blog/seurat/">Seuratを使ってみる</a>
        </h2>
        <div class="post-data">
            Mar 30, 2020 |
            
        </div>
        
        <div class="blog-share">
            :
            
            <a class="twitter-share-button" href="https://twitter.com/intent/tweet?text=Seurat%e3%82%92%e4%bd%bf%e3%81%a3%e3%81%a6%e3%81%bf%e3%82%8b%20https%3a%2f%2fwww.tsumar.com%2fblog%2fseurat%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fab fa-twitter"></i>
                <span class="hidden">Twitter</span>
            </a>
            
            
            <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.tsumar.com%2fblog%2fseurat%2f"  onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                <i class="fab fa-facebook-f"></i>
                <span class="hidden">Facebook</span>
            </a>
            
            
            <a class="icon-pinterest" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fwww.tsumar.com%2fblog%2fseurat%2f&amp;description=Seurat%e3%82%92%e4%bd%bf%e3%81%a3%e3%81%a6%e3%81%bf%e3%82%8b" onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
                <i class="fab fa-pinterest-p"></i>
                <span class="hidden">Pinterest</span>
            </a>
            
            
            <a class="icon-google-plus" href="https://plus.google.com/share?url=https%3a%2f%2fwww.tsumar.com%2fblog%2fseurat%2f" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                <i class="fab fa-google-plus-g"></i>
                <span class="hidden">Google+</span>
            </a>
            
        </div>
        
        
    </div>
    
    <div class="container markdown top-pad">
        <p>(2019.06.15)</p>
<h3 id="seurat-tutorialを行なって">Seurat tutorialを行なって</h3>
<p>single cell解析パイプラインであるSeuraのtutorialを行なってみて，今後全ての解析において注意していかないといけない，いくつかの事柄があったので記載する。</p>
<h3 id="データのスケーリング線形変換">データのスケーリング（線形変換)</h3>
<p>PCAなどで，細胞ごとの特徴を比較する際に，カウント結果などを線形変換により正規化することは重要である。
これを行わない場合，発現の高い遺伝子がPCAなどのクラスタリング結果に与える影響が大きくなってしまう。</p>
<h3 id="優位に発現が変動している遺伝子の抽出">優位に発現が変動している遺伝子の抽出</h3>
<p>必ずしも全遺伝子を対象に次元削減を行う必要はない。その前に，群を意識せずにサンプル全体に対して，あるサンプルで優位に発現が変動している遺伝子だけを取り出し，その遺伝子のみをPCAなどの対象にすることができる。この際Seuraのデフォルトでは標準偏差1を利用していた。</p>
<h3 id="データセットの次元を決定する">データセットの次元を決定する</h3>
<p>メタデータに対してPCAを行い，影響の大きいPCの数でデータの次元を決定する。
ランダムにデータのサブセットを取り出しPCAを繰り返して重要なPCの数を決定する方法もあるが，時間がかかる。
簡単に行う場合は <code>heuristic method generates an ‘Elbow plot’</code> を行うのが良い。
各PCの分散を計算し，横軸にPC，縦軸にPCでプロットすることで単純に次元ごとの分散を目視することができる。
この際に，本当に消去していいPCか見るために，各PCでtopの遺伝子を表示して実際に確認してみるのも良い。</p>
<p>この次元は，UMAPやtSNEで次元削減した際にグループとして認識するためのセルクラスターの数の計算に利用される。tSNEなどでの色の違いは，セルを統計的にクラスタリングした結果を表している。
SeuratではまずKNNを行うのだが，この時に先ほど決定した次元を指定してクラスの数を規定するのである。
Seuratでは，Louvainアルゴリズム（デフォルト）またはSLMを使用して，クラスタリングを最適化している。</p>

    </div>
    
    



                
                <div class="container">
    <hr>
</div>
<div class="container has-text-centered top-pad">
    <a href="#top">
        <i class="fa fa-arrow-up"></i>
    </a>
</div>

<div class="container">
    <hr>
</div>

                <div class="section" id="footer">
    <div class="container has-text-centered">
    
        <span class="footer-text">
            
        </span>
    
    </div>
</div>

                
            </div>
        </section>
        
        


<script src="https://www.tsumar.com/js/bundle.e6934e69d06bb8a213134f4c1468f9478bb7755e786dfb60e3c5a917c5335805.js" integrity="sha256-5pNOadBruKITE09MFGj5R4u3dV54bftg48WpF8UzWAU="></script>



        
        
        
        
    </body>
</html>
